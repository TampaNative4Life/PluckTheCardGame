using System;
using System.Collections.Generic;
using System.Linq;
using System.Windows.Forms;
using System.Drawing;

public class PluckGameForm : Form
{
    private Label dealerLabel;
    private Label trumpLabel;
    private Button playRoundButton;
    private ListBox player1Hand;
    private ListBox player2Hand;
    private ListBox player3Hand;
    private TextBox gameLog;

    private Game game;

    public PluckGameForm()
    {
        this.Text = "Pluck Card Game";
        this.Size = new Size(800, 600);

        dealerLabel = new Label() { Text = "Dealer: ", Location = new Point(20, 20), AutoSize = true };
        trumpLabel = new Label() { Text = "Trump: ", Location = new Point(20, 50), AutoSize = true };
        
        playRoundButton = new Button() { Text = "Play Round", Location = new Point(20, 80) };
        playRoundButton.Click += PlayRound_Click;

        player1Hand = new ListBox() { Location = new Point(20, 120), Size = new Size(200, 150) };
        player2Hand = new ListBox() { Location = new Point(300, 120), Size = new Size(200, 150) };
        player3Hand = new ListBox() { Location = new Point(580, 120), Size = new Size(200, 150) };
        
        gameLog = new TextBox() { Location = new Point(20, 300), Size = new Size(760, 200), Multiline = true, ReadOnly = true };

        this.Controls.Add(dealerLabel);
        this.Controls.Add(trumpLabel);
        this.Controls.Add(playRoundButton);
        this.Controls.Add(player1Hand);
        this.Controls.Add(player2Hand);
        this.Controls.Add(player3Hand);
        this.Controls.Add(gameLog);

        game = new Game();
        UpdateUI();
    }

    private void PlayRound_Click(object sender, EventArgs e)
    {
        game.PlayRound();
        UpdateUI();
    }

    private void UpdateUI()
    {
        dealerLabel.Text = $"Dealer: {game.GetDealer()}";
        trumpLabel.Text = $"Trump: {game.GetTrumpSuit()}";

        player1Hand.Items.Clear();
        player2Hand.Items.Clear();
        player3Hand.Items.Clear();

        foreach (var card in game.GetPlayerHand("Player 1"))
            player1Hand.Items.Add(card);
        foreach (var card in game.GetPlayerHand("Player 2"))
            player2Hand.Items.Add(card);
        foreach (var card in game.GetPlayerHand("Player 3"))
            player3Hand.Items.Add(card);

        gameLog.Text += "\n" + game.GetLatestLog();
    }
}

class Program
{
    [STAThread]
    static void Main()
    {
        Application.EnableVisualStyles();
        Application.Run(new PluckGameForm());
    }
}
